<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8"
      crossorigin="anonymous"
    ></script>
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
      integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
      crossorigin=""
    />
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script
      src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
      integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
      crossorigin=""
    ></script>

    <title>Map</title>
  </head>
  <body
    class="
      container-fluid
      justify-content-center
      align-items-center
      d-flex
      flex-column
      p-3
    "
  >
    <div id="mapid" style="height: 25vw; width: 75vw"></div>
    <button
      class="btn btn-outline-primary mt-4"
      id="button-marker"
      onclick="clickButton()"
    >
      Add Marker
    </button>

    <script>
      const mymap = L.map("mapid").setView([-6.121435, 106.774124], 13);
      let lat;
      let lng;
      let toggle = false;

      function clickButton() {
        if (toggle) {
          toggle = false;
          document.getElementById("button-marker").className =
            "btn btn-outline-primary";
        } else {
          toggle = true;
          document.getElementById("button-marker").className =
            "btn btn-primary";
        }
      }
      let markers = [];

      L.tileLayer(
        "https://api.mapbox.com/styles/v1/{id}/tiles/1/1/0?access_token={accessToken}",
        {
          attribution:
            'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
          maxZoom: 18,
          id: "mapbox/streets-v11",
          tileSize: 512,
          zoomOffset: -1,
          accessToken:
            "pk.eyJ1Ijoic3VsMTIiLCJhIjoiY2tva3Voc2NpMDk0dzJ2cGVybWE3NzdxOSJ9.Qm7bDCBfok8n9y82_8KJ-w",
        }
      ).addTo(mymap);

      function clickMap(e) {
        lat = e.latlng.lat;
        lng = e.latlng.lng;
        if (toggle) {
          if (markers.length === 0) {
            markers.push({
              id: 1,
              marker: L.marker([lat, lng])
                .addTo(mymap)
                .bindPopup(`You clicked marker: 1`),
            });
          } else {
            markers.push({
              id: markers.length + 1,
              marker: L.marker([lat, lng])
                .addTo(mymap)
                .bindPopup(`You clicked marker: ${markers.length + 1}`),
            });
          }
        }
      }
      mymap.on("click", (e) => clickMap(e));
    </script>
  </body>
</html>
